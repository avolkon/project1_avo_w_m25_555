"""
constants.py
# Глобальные константы игры: карта комнат, предметы, загадки.
"""

ROOMS = {
    'entrance': {
        'description': 'Вы в тёмном входе лабиринта. Стены покрыты мхом. На полу лежит старый факел.',
        'exits': {'north': 'hall', 'east': 'trap_room'},
        'items': ['torch'],
        'puzzle': None
    },

    # Новые комнаты Финальная - Сокровищница:
    'treasure_room': {
    'description': 'Сокровищница! Золотой сундук сияет в лучах света.',
    'exits': {'south': 'hall'},
    'items': ['treasure_chest'],
    'puzzle': (
        'На сундуке написано: "Ты сможешь открыть меня, если вспомнишь о самом дорогом, что имеешь в жизни, и вот тебе подсказка:\nВ печали молчит, а в счастье поёт,\nБез неё — тело есть,  а человек не живёт.\nОна не стареет, не рвётся, не тлеет,\nА лишь растёт, если сердце умеет.',
        'душа'
        )
    },

    'hall': {
        'description': 'Большой зал с эхом. По центру стоит пьедестал с запечатанным сундуком.',
        'exits': {'south': 'entrance', 'west': 'library', 'north': 'treasure_room'},
        'items': [],
        'puzzle': (
            'На пьедестале надпись: "Назови число, которое идёт после девяти".\nВведи ответ цифрой.',
            '10'
        )
    },
    'trap_room': {
        'description': 'Комната с хитрой плиточной поломкой. На стене видна надпись: "Осторожно — ловушка".',
        'exits': {'west': 'entrance'},
        'items': ['rusty_key'],
        'puzzle': (
            'Система плит активна. Чтобы пройти, назови слово "шаг" три раза подряд (введи "шаг шаг шаг").',
            'шаг шаг шаг'
        )
    },
    'library': {
        'description': 'Пыльная библиотека. На полках старые свитки. Где‑то здесь может быть ключ от сокровищницы.',
        'exits': {'east': 'hall', 'north': 'armory', 'southwest': 'chapel'},
        'items': ['ancient_book'],
        'puzzle': (
            'В одном свитке загадка: "Я не огонь, но согреваю души. \nЯ не вода, но утоляю жажду знаний. \nЧто я?"', 
            'книга'
        )
    },
    'armory': {
        'description': 'Старая оружейная комната. На стене висит меч, рядом — небольшая бронзовая шкатулка.',
        'exits': {'south': 'library'},
        'items': ['sword', 'bronze_box'],
        'puzzle': None
    },

    # Новая комната 1: Заброшенная часовня
    'chapel': {
        'description': 'Заброшенная часовня с разбитыми витражами. В центре — каменный алтарь со следами воска.',
        'exits': {'south': 'secret_tunnel', 'west': 'library'},
        'items': ['candle', 'silver_cross'],
        'puzzle': (
            'На алтаре выгравировано: "Я ласкаю, но обжигаю.\nЯ согреваю, но могу убить.\nЯ рождаюсь от искры, а умираю от воды.\nКто я?"\n(ответ — одно слово маленькими буквами).',
            'огонь',
            # ('"Я мягкий, как пух, но ломаю деревья. \nЯ тихий, как шёпот, но рву паруса. \nЧто я?\n(ответ - 1 слово маленькими буквами)"',
            # 'ветер')
        )
    },

    # Новая комната 2: Тайный туннель
    'secret_tunnel': {
        'description': 'Узкий сыроватый туннель. С потолка свисают корни деревьев. Вдалеке мерцает тусклый свет.',
        'exits': {'north': 'chapel', 'west': 'underground_spring'},
        'items': ['rotten_wood', 'glowing_mushroom'],
        'puzzle': (
            'На стене царапина: "Я умираю, когда ты светишь, \nНо рождаюсь, когда ты гасишь свет. \nЧто я?\n(ответ - 1 слово маленькими буквами)"',
            'темнота'
        )
    },

    # Дополнительно: Подземный источник (для связи с туннелем)
    'underground_spring': {
        'description': 'Пещера с кристально чистым Источником. Вода издаёт тихий звон. У берега важный артефакт, который поможет добраться до центра Источника.',
        'exits': {'east': 'secret_tunnel'},
        'items': ['small_boat', 'water_flask'],
        'puzzle': ( 
            'Чтобы получить артефакт, разгадай загадку: "Скольжу по воде, как по шёлку легко,\nХраню я улов и мечты моряков\nЧто я?"\n(ответ - 1 слово маленькими буквами)',
            'лодка',
            # ('В маленькой лодке надпись: "Я бегу, но не устаю.\nЯ меняю форму, но не суть.\nЯ бываю мягка, как шёлк,\nИли тверда, как сталь.\nКто я?"\n(ответ - 1 слово маленькими буквами)',
            # 'вода')
        )
    }
}

# Основные константы игры
START_ROOM = 'entrance'
WIN_ROOM = 'treasure_room'


# Доступные команды игрока
COMMANDS = [
    'идти', 'go', 'назад', 'back', 'взять', 'take', 'применить', 'use', 'артефакты', 'items',
    'осмотреть', 'look', 'помощь', 'help', 'описание', 'describe', 'решить', 'solve', 'quit',
    'exit', 'выход'
]

# Шаблонные сообщения
MESSAGES = {
    'win': 'Поздравляем! Вы нашли сокровища и победили лабиринт!',
    'lose': 'Вы проиграли. Попробуйте снова.',
    'invalid_command': 'Неизвестная команда. Введите "помощь", чтобы увидеть список команд.',
    'no_exit': 'В этом направлении выхода нет.',
    'item_not_found': 'Такого предмета здесь нет.',
    'puzzle_solved': 'Загадка решена! Теперь можно двигаться дальше.',
    'puzzle_failed': 'Неверный ответ. Попробуйте ещё раз.',
    'item_taken': 'Вы взяли: {}',
    'already_have': 'У вас уже есть этот предмет.',
    'nothing_to_take': 'Здесь нет предметов для взятия.'
}

TOTAL_PUZZLES = len([r for r in ROOMS if ROOMS[r].get('puzzle')])